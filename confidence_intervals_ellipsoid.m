% ---------------------------------------------------------------------------
% ¬ычисление доверительных интервалов оценок
% ---------------------------------------------------------------------------
function [CI_lower, CI_upper] = confidence_intervals_ellipsoid(X0, K, alpha)
    % X0 - вектор математического ожидани€ (n x 1)
    
    % K - ковариационна€ матрица (n x n)
    % –анее в   обнулены GAUGE_FREEDOM наименьших собственных значений
    
    % alpha - уровень значимости (например, 0.05 дл€ 95% доверительного интервала)

    %  ритическое значение дл€ нормального распределени€
    z = norminv(1 - alpha / 2);

    % ¬ычисление собственных значений и собственных векторов
    [V, D] = eig(K);

    % —обственные значени€
    eigenvalues = diag(D);

    % ¬ычисление доверительных интервалов дл€ всех элементов вектора X
    CI_lower = X0 - z * V * sqrt(abs(eigenvalues));
    CI_upper = X0 + z * V * sqrt(abs(eigenvalues));

    % ”бедитьс€, что нижние границы меньше или равны верхним границам
    CI_temp = [CI_lower, CI_upper];
    CI_lower = min(CI_temp, [], 2);
    CI_upper = max(CI_temp, [], 2);
end
